\documentclass[10pt,a4paper]{article}
\usepackage[latin1]{inputenc}
\usepackage[spanish]{babel}
\usepackage{multicol}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{enumerate}
\usepackage{eurosym}
\usepackage{graphicx}
\usepackage{anysize}
\usepackage{colortbl}
\usepackage{hyperref}
\usepackage{lscape}
\usepackage{float}
\usepackage{longtable}
\usepackage{fancyhdr}
\pagestyle{fancy}
\marginsize{3cm}{2cm}{2cm}{2cm}
\author{David Rufo Valero}
\title{Diseño Técnico}
\begin{document}

\thispagestyle{empty}
\begin{center}
\includegraphics[scale=1]{logoURJC.jpg} \\[1cm]
\textbf{\Huge Universidad Rey Juan Carlos}\\[0.5cm]
{\LARGE Escuela Técnica Superior de Ingeniería Informática}\\[1.25cm]
{\Large Ingeniería del Software II}\\[1.25cm]
{\LARGE \textbf{Práctica Obligatoria}}\\[1.25cm]
{\LARGE \textit{Documento de Diseño Técnico}}\\[2.5cm]
{\Large Radu Tom Vlad \\ David Rufo Valero \\ Jesús Sánchez-Oro Calvo \\ Adrián Santalla Romero de Ávila }\\[1cm]
{\Large asantalla@siliconkernel.com}\\[2cm]
5º de Ingeniería Informática \\[1cm]
\today

\end{center}

\newpage
\fancyhead[LO,LE]{Ingeniería del Software II}
\fancyhead[RO,RE]{Diseño Técnico}
%\fancyfoot[LO,LE]{\thepage}
\tableofcontents

\newpage

\listoffigures

\newpage

\section{DSI 1: Definición de la Arquitectura del Sistema}

\subsection{DSI 1.1: Definición de Niveles de Arquitectura}
	El particionamiento físico que será realizado en el sistema se muestra un esquema en la figura siguiente:
	\begin{figure}[h]
		\begin{center}
			\includegraphics[scale=0.4]{despliegueSistema.jpg}
			\caption{Diagrama de despliegue del sistema.}		
		\end{center}
	\end{figure}
	
	Los elementos o nodos de la figura se explican a continuación.
	Por un lado el sistema tendrá una \textbf{base de datos} en la que se almacenará la siguiente información:
	\begin{itemize}	
		\item \textit{Tabla Usuarios}: se guardará datos de los clientes registrados, como por ejemplo su Nombre Personal, Apellidos, DNI, Nombre de Usuario, Contraseña, Dirección Particular, Teléfonos de contactos, etc. El campo de la contraseña no será una cadena simple de texto sino que se almacenará con una cierta codificación para la seguridad del usuario.
		\item \textit{Tabla Pedidos}: cualquier cliente previamente registrado puede realizar un pedido a través del portal, una vez hecha tal acción se guardarán los datos necesarios, como pueden ser la información del Usuario que está realizando el pedido, el nombre del producto junto con una referencia asociada a dicho producto (esta referencia será la misma que tenga ese producto en la tabla correspondiente a los productos), etc.
		\item \textit{Tabla Colecciones}: se almacenan las colecciones filatélicas. Los datos a guardar son el nombre de la colección, una descripción de ésta, código,...
		\item \textit{Tabla Productos}: en esta tabla se almacenarán todo tipo de información que describa un producto, es decir, su nombre, código o referencia, descripción, precio, etc. 
		\item \textit{Tabla Envíos}: en ella se guardarán los datos de los envíos, como pueden ser la información del Usuario registrado que realizó el envío, la localización del envío, el código o referencia, descripción o información referente al envío, dirección, etc.
		\item \textit{Tabla Asociaciones}: almacenamiento de asociaciones referentes a las asociaciones filatélicas. Luego se guardarán teléfonos de esas asociaciones, direcciones, etc. En la aplicación se mostrará un mapa para que el usuario registrado o no puede ver las asociaciones filatélicas más cercanas a su situación, aunque también podrá ver todas las demás.
		\item \textit{Tabla Información}: en la que se guardarán los datos referentes al resto de la aplicación, es decir, la información de las paginas web estáticas y los demás datos que no se pueden agrupar en una tabla específica.
	\end{itemize}
	Ya en la implementación se decidirá que campos son los realmente básicos en cada una de las tablas.
	
	Los datos de las tablas irán creciendo con el paso del tiempo, aunque también el administrador del sistema irá haciendo desaparecer cierta información que ya no sea necesaria desde ese momento. Por lo que el volumen de la base de datos continuará creciendo día a día.\\

	En el servidor es donde se encuentra la lógica de negocio. En él se encontrarán los distintos gestores (de Correos, de Envíos, de Filatelia y de la Oficina Virtual) a través de los cuales se accederá a la base de datos en el caso de ser necesario.\\
	
	El usuario realizará las operaciones que él desee dependiendo de si es un usuario Anónimo, Registrado o un usuario referente a una empresa. Y todas estas acciones establecerán una comunicación con el servidor para que éste le responda con la información adecuada a la consulta realizada por el usuario.\\
	
	Por lo tanto las comunicaciones entre los distintos nodos son:
	\begin{itemize}
		\item El Servidor realizará consultas al Servidor de Base de Datos y éste le responderá con la información adecuada a la consulta realizada. La comunicación entre Servidor y ServidorBBDD, será mediante una conexión de red local (LAN).
		\item El Usuario a través de las distintas opciones de la página web principal de Correos (www.correos.es) irá realizando las consultas a la información que desea o llevar a cabo los operaciones o transacciones que considere oportunas en el caso de ser un usuario registrado. Esta comunicación, entre Usuario y Servidor, será realizada a través de Internet (TCP/IP) por lo que un requisito fundamental en la parte del cliente será la conexión a Internet para el uso de esta aplicación y el requisito fundamental del Servidor es estar en un dominio con una accesibilidad pública para su localización y uso.
	\end{itemize}
	
	Para evitar la saturación del servidor se utilizarán varios de éstos, ya que la media de acceso al portal es de 400.000 (cuatrocientas mil) visitas al mes. Así se evita que los usuarios no vean un cierto retraso a la hora de responder el servidor sobre una determinada acción pedida por el cliente.\\
	
	Los problemas de concurrencia que podrían surgir cuando se dispone de varios servidores y cada uno tenga accesos al servidor de bases de datos serán solucionados con las técnicas de programación adecuadas para la consistencia de los datos. Por ejemplo, una solución a este problema podría ser el evitar que más de un servidor acceda a un registro de una tabla, con esto se evitaría la inconsistencia de los datos entre servidores a la hora de responder con datos al cliente.\\
	
	Respecto a la seguridad, las comunicaciones una vez el usuario ha sido registrado y ha entrado correctamente en la aplicación, se usarán conexiones seguras con el fin de no tener problemas con otros usuarios o con usuarios cuyas acciones son mal intencionadas.\\
	
	En el caso de usuarios con discapacidades también tendrán la posibilidad de utilizar esta aplicación web debido a que se incluirán los métodos apropiados para el uso adecuado para estas personas.
	
\subsection{DSI 1.2: Identificación de Requisitos de Diseño y Construcción}
	Los requisitos relacionados con el diseño de la aplicación son:
	\begin{itemize}
		\item El \textit{lenguaje} utilizado en la web será un lenguaje común para que cualquier usuario pueda ser capaz de leer y entender correctamente la información que desea este usuario, tanto los anónimos como los registrados. Por lo que éstos no deberán tener un nivel educativo y cultural demasiado amplio para su uso.
		\item Las operaciones o transacciones que pueda realizar un cliente registrado serán bastante accesibles y con la suficiente información para su realización correcta. Aunque durante el horario establecido de atención al cliente siempre podrá llamar el usuario para resolver cualquier duda.
		\item El \textit{rendimiento} ofrecido por los \textit{servidores} será el máximo posible de cada uno de ellos para evitar el colapso de éstos y que la aplicación no funcione debido a éstos problemas. El rendimiento máximo de estos servidores dependerá del uso actual de la web, es decir, según el número de usuarios que en cada momento estén utilizando la aplicación. Estos servidores guardarán la lógica de negocio de la aplicación.
		\item Además el \textit{rendimiento} ofrecido por el \textit{servidor de base de datos} será también máximo dependiendo de su interacción con los otros servidores. En este servidor se guardarán todos los datos de la aplicación de forma permanente y con sus correspondientes copias de seguridad cada un cierto período, el cual todavía no se ha establecido, ya que dependerá de su volumen.
		\item Los servidores y el servidor de base de datos estarán ubicados en el mismo lugar ya que su comunicación se realizará a través de una conexión de red local (LAN).
		\item La conexión entre Usuario y Servidor será a través de Internet (TCP/IP).
	\end{itemize}

\subsection{DSI 1.3: Especificación de Excepciones}
	Los comportamientos no habituales de la aplicación, que puede darse en algún momento, son:
	\begin{itemize}
		\item \textit{Caída de los servidores}: los usuarios no podrán utilizar la aplicación. Los elementos afectados serán los propios a la lógica de negocio. El motivo de esta situación puede surgir por una caída de luz en las instalaciones o una renovación de los equipos, aunque esto último será realizado poco a poco para poder evitar dicha situación.
		\item \textit{Caída del Servidor de Base de Datos}: los usuarios podrán utilizar la aplicación pero no podrán realizar acciones que requieran de información de la base de datos. Por ejemplo, usuarios registrados no podrán entrar en la aplicación, las consultas de tarifas de los productos no podrán ser vistas por los usuarios,... El elemento afectado será la base de datos. Su motivo puede ser, al igual que antes, una caída de la luz o la actualización de la base de datos.
		\item \textit{Comunicación entre Servidores y Servidor de BBDD}: puede ocurrir la situación de que la conexión de red local entre ellos caiga debido bien a la ruptura de un cable o bien por desenchufar el servidor de BBDD o algún otro servidor del switch con el que tienen comunicación estos nodos. El elemento afectado es la conexión de red local.
		\item Puede suceder que el usuario en un campo donde sólo deberían introducirse números inserte algún carácter no válido y la aplicación produzca la excepción de caracteres no válidos. Por lo tanto este tipo de excepciones serán tratadas para que la aplicación avise al usuario del tipo de información a rellenar en cada campo para evitar estas situaciones.
		\item El usuario también deberá tener especial cuidado cuando introduzca fechas ya que no estará permitido por la aplicación la inclusión de fechas anteriores al día actual. Por ejemplo, si el usuario pretende realizar un envío no podrá proporcionar la fecha inicial anterior al día actual. Además se indicará el orden de la fecha, por ejemplo Día/Mes/Año.
	\end{itemize} 

\subsection{DSI 1.4: Especificación de Estándares y Norma de Diseño y Construcción}
	La aplicación será construida siguiendo estos estándares:
	\begin{itemize}
		\item \textbf{W3C}: mediante este estándar se consigue que la aplicación sea multiplataforma y accesible desde la mayor parte de los navegadores, ya que una vez que la aplicación pasa el test del validador de la W3C (http://validator.w3.org), ésta puede usarse en cualquier navegador que siga dicho estándar.
		\item \textbf{Nivel A de Conformidad con las Directrices de Accesibilidad para el Contenido Web 1.0 (WCAG 1.0)}: las Directrices de Accesibilidad para el Contenido Web 1.0 explican cómo hacer el contenido Web accesible para las personas con discapacidad. Ajustándose a estas Directrices ayudará a hacer la Web más accesible a los usuarios con discapacidades y beneficiará a todos los usuarios.
	\end{itemize}
	
	Referente a la legislación, la principal ley que se debe tener en cuenta es la \textbf{Ley Orgánica de Protección de Datos de Carácter Personal}, que como indica en su artículo 1, tiene como objetivo \textit{garantizar y proteger, en lo que concierne al tratamiento de los datos personales, las libertades públicas y los derechos fundamentales de las personas físicas, y especialmente de su honor e intimidad personal y familiar}. Esto es de vital importancia en cualquier tipo de aplicación que maneje datos con información privada de sus usuarios, por lo que el nuevo portal deberá tenerlo en cuenta.

\subsection{DSI 1.5: Identificación de Subsistemas de Diseño}
	En el sistema podemos encontrar cuatro grandes subsistemas de diseño, los cuales son los siguientes:
	\begin{itemize}
		\item \textbf{Gestor de correos:} Es el encargado de la gestión de usuarios, y realiza acciones tales como registrar y validar del sistema a usuarios de correos. Además se encarga de obtener la información buscada por los clientes. Por lo que interactuará con la base de datos de usuarios del sistema y con las bases de datos referentes a la información (asociaciones, colecciones y productos).
		\item \textbf{Gestor de envíos:} Es el encargado de la realización, cancelación y seguimiento de los envíos realizados por los clientes. Por lo que interactuará con la base de datos de envíos y de usuarios del sistema.
		\item \textbf{Gestor de Filatelia:} Es el encargado de realizar todas las gestiones que el sistema debe realizar referentes al apartado filatélico. Por lo que interactuará con las bases de datos de productos, colecciones y pedidos.
		\item \textbf{Gestor de Oficina Virtual:} Es el encargado de realizar todas las gestiones que el sistema debe realizar referentes a la Oficina Virtual de correos. Por lo que interactuará con las bases de datos de usuarios y pedidos.
	\end{itemize}
		
	El diagrama de componentes que muestra las relaciones entre los diferentes subsistemas es el siguiente:
	\begin{figure}[H]
		\begin{center}
			\includegraphics[scale=0.4]{paquetes.jpg}
			\caption{Diagrama de paquetes.}
		\end{center}	
	\end{figure}

\subsection{DSI 1.6: Especificación del Entorno Tecnológico}
	Las características que debe tener el \textit{Servidor de Base de Datos} son:
	\begin{itemize}
		\item \textbf{Hardware}:
				\begin{itemize}
					\item Sistema de Almacenamiento: disco duro con una capacidad inicial de dos terabytes (2 TB).
					\item Memoria RAM: inicialmente sería suficiente con dos gigabytes (2 GB).
					\item Tarjeta de Red: estándar RJ45 para la comunicación con los demás servidores.
					\item Unidad DVD de grabación o puerto USB: para copias de seguridad periódicas.
					\item Procesadores: inicialmente con un procesador debería ser suficiente (estos inicialmente serán de la marca Intel).
					\item Teclado, ratón y demás componentes necesarios para el correcto encendido de esta computadora.
				\end{itemize}
		\item \textbf{Software}:
				\begin{itemize}
					\item Sistema Operativo: Windows NT/200 Advanced Server.
					\item Base de Datos: Oracle (Lenguaje de consulta estructurado SQL).
					\item Software para la realización de las copias de seguridad.
					\item En caso de que sea necesario: software para la comunicación con los demás servidores. 
				\end{itemize}
		\item No deberá permitir la conexión de otros servidores. Y tampoco debería permitir que los servidores, apropiados para la conexión, puedan situarse en el mismo registro de una misma tabla con el fin de evitar inconsistencia en la información.
	\end{itemize}
	
	Las características de los \textit{Servidores} son:
	\begin{itemize}
		\item \textbf{Hardware}:
				\begin{itemize}
					\item Sistema de Almacenamiento: disco duro con una capacidad inicial de quinientos gigabytes (500 GB). Dentro de este sistema habrá una pequeña parte para una caché en la que se guardarán los datos de las consultas, su tamaño podría ser de dos gigabytes (2 GB).
					\item Memoria RAM: inicialmente sería suficiente con cuatro gigabytes (4 GB).
					\item Tarjeta de Red: estándar RJ45 para la comunicación con el servidor de base de datos.
					\item Procesadores: inicialmente se utilizará un Intel Dual Core.
					\item Teclado, ratón y demás componentes necesarios para el correcto encendido de estas computadoras.
				\end{itemize}
		\item \textbf{Software}:
				\begin{itemize}
					\item Sistema Operativo: Windows NT/200 Advanced Server.
					\item Navegador: para la comprobación del correcto funcionamiento del sistema.
					\item En caso de que sea necesario: software para la comunicación con el servidor de base de datos. 
					\item Entorno de desarrollo: puede ser un procesador de textos normal a través del cual realizar todo lo referente a la implementación.
				\end{itemize}
		\item Los usuarios accederán a éstos a través de Internet (TCP/IP) por lo que la aplicación deberá alojarse en un dominio para su posible utilización.
	\end{itemize}
	
	Las características que deben tener las computadores de los \textit{Usuarios} son:
	\begin{itemize}
		\item \textbf{Hardware}:
				\begin{itemize}
					\item Tarjeta de Red o tarjeta de red inalámbrica: para la conexión a internet.
					\item Teclado, ratón y demás componentes necesarios para el correcto encendido de estas computadoras.
				\end{itemize}
		\item \textbf{Software}:
				\begin{itemize}
					\item Sistema Operativo: Windows, Linux o Macintosh.
					\item Navegador Web: para el acceso a la aplicación. (Internet Explorer, Mozilla Firefox,...) Estos navegadores web deben tener activado el permiso de ejecución de JavaScript.
				\end{itemize}
		\item Requisito fundamental en estas computadoras es su conexión a Internet para tener comunicación con los servidores.
	\end{itemize}

\subsection{DSI 1.7: Especificación de Requisitos de Operación y Seguridad}
	La aplicación cuenta con los siguiente mecanismos de seguridad:
	\begin{itemize}
		\item Los servidores de base de datos realizarán copias de seguridad (Backup) de forma periódica (este tiempo esta por decidir según la cantidad de información almacenada). Además para la concurrencia este servidor utilizará un mecanismo que no permitirá a más de un servidor acceder al mismo registro de una tabla.
		\item El accesos al servidor de base de datos será sólo desde la red local, por lo tanto no estará conectada a Internet. Además sólo los servidores autorizados tendrán acceso a la información almacenada en éste. Para ésto se utilizara una nombre de usuario y una contraseña (cifrada) para entrar en servidor de BBDD. 
		\item Los demás servidores tendrán un grupo de usuarios con sus correspondientes contraseñas (cifradas) que permitirán la entrada a estas computadoras. Éstas estarán conectadas a Internet pero no se permitirá la conexión remota a menos que alguno de los administradores de estos servidores lo permite en un momento determinado.
		\item Los servidores que contendrán la lógica de negocio, a parte de disponer un usuario y clave para entrar en ellos, también se necesitará permisos de administrador para la modificación de aspectos relacionados con la aplicación.
		\item Los datos de los usuarios registrados estarán protegidos debido a la Ley Orgánica de Protección de Datos de Carácter Personal.
		\item En el caso de producirse una pérdida total de los datos se recuperarán estos a partir de última copia de seguridad hecha.
		\item Durante la franja horaria de mayor número de usuarios se tendrá especial cuidado con las transacciones realizada por cada uno de ellos para evitar problemas en los datos y la inclusión de usuarios mal intencionados. Por lo que en este período de tiempo los servidores estarán funcionando a pleno rendimiento.
	\end{itemize}


\newpage


\section{DSI 2: Diseño de la Arquitectura de Soporte}

\subsection{DSI 2.1: Diseño de Subsistemas de Soporte}
	Los subsistemas de soporte serán exactamente los mismos que los mencionados en el punto 1.5 de éste documento.	
	
\subsection{DSI 2.2: Identificación de Mecanismos Genéricos de Diseño}
	Algunos de los mecanismos genéricos de diseño que podemos encontrar en la aplicación son:
	\begin{itemize}
		\item La \textit{recogida de datos} insertados en formularios por un usuario registrado con el fin de realizar alguna transacción. Por ejemplo: realizar un pedido, el envío de un documento,... En el caso de observar algún error en los datos introducidos se avisará al usuario con la correspondiente información de cómo rellenar el campo o los campos que han fallado.
		\item La \textit{inserción, borrado o actualización} de información en la \textit{BD} será de la misma forma a diferencia de la tabla en cuestión a utilizar. 
			\begin{itemize}
				\item \textit{Inserción}: primero se establece la conexión con el servidor de la BD, se mira que no exista ya esa información en ella, se inserta y se cierra la conexión.
				\item \textit{Borrado}: establecimiento de la conexión con el servidor de la BD, ver si existe, borrado y cierre de conexión.
				\item \textit{Actualización}: establecer la conexión con el servidor de la BD, ver si existe, actualizar y cerrar la conexión.
			\end{itemize}
		\item Se establecerán los \textit{mecanismos de concurrencia} necesarios para el acceso a recursos comunes y críticos.
		\item La \textit{visualización de la información} por al usuario será realizado de la misma manera siempre y el tipo de letra a utilizar será la misma (ya en la implentación deberá especificarse con mayor detalle este punto).
		\item El \textit{inicio de sesión} para los usuario registrados será comprobado de la misma forma: conexión con el servidor de BD, en la tabla usuarios buscar el nombre de usuario insertado y comprobar que los datos coincidan, redireccionar a la pagina principal si sus datos son correctos y cierre de la conexión. En el caso de datos incorrectos se mostrará un mensaje de error correspondiente.
		\item El \textit{cierre de sesión} se lleva a cabo de la misma forma comprobando que el usuario esté previamente con una sesión activa.
		\item La \textit{muestra de información de error} tanto en el inicio de sesión como en la inserción de datos en formularios se realizará de la misma manera.
	\end{itemize}


\newpage


\section{DSI 3: Diseño de Casos de Uso Reales}

\subsection{DSI 3.1: Identificación de Clases Asociadas a un Caso de Uso}
	

\subsection{DSI 3.2: Diseño de la Realización de los Casos de Uso}
	Los diagramas de secuencia que nos informan de como se llevan a cabo los distintos casos de uso son los que se muestran a continuación:
	\begin{itemize}
	\item \textbf{Login}:
		\begin{figure}[H]
			\begin{center}
				\includegraphics[scale=0.4]{disenologin_correcto.jpg}
				\caption{Diagrama de secuencia de login (correcto).}
			\end{center}	
		\end{figure}		
		
		\begin{figure}[H]
			\begin{center}
				\includegraphics[scale=0.4]{disenologin_incorrecto.jpg}
				\caption{Diagrama de secuencia de login (incorrecto).}
			\end{center}	
		\end{figure}
		
		Un usuario, previamente registrado, introduce sus datos en la aplicación y pulsa el botón ``Entrar", entonces el Gestor de usuarios comprueba los datos mediante una consulta a la base de datos y hay dos posibilidades:
			\begin{itemize}
				\item Datos Correctos: la BD devuelve ``OK" y el gestor de usuarios devuelve ``OK". Si todo va bien la aplicación redirige al usuario a la pantalla principal de usuarios registrados.
				\item Datos Incorrectos: la BD devuelve ``ValidationError" y el gestor de usuarios devuelve ``ValidationError". Por lo que en este caso se le mostrará al usuario información semejante a: su nombre o contraseña no son correctos.
			\end{itemize}
		
	\item \textbf{Logout}:				
		\begin{figure}[H]
			\begin{center}
				\includegraphics[scale=0.4]{disenologout_correcto.jpg}
				\caption{Diagrama de secuencia de logout (correcto).}
			\end{center}	
		\end{figure}
		
		\begin{figure}[H]
			\begin{center}
				\includegraphics[scale=0.4]{disenologout_incorrecto.jpg}
				\caption{Diagrama de secuencia de logout (incorrecto).}
			\end{center}	
		\end{figure}
		
		Cuando el usuario considere oportuno podrá cerrar la sesión pulsando en sobre el enlace correspondiente, entonces el gestor de Usuarios recoge la información y mediante una consulta a la base de datos podrán ocurrir las siguientes situaciones:
		\begin{itemize}
			\item El usuario tiene una sesión activa y desea cerrarla: la BD devuelve ``OK" y el gestor de usuarios devuelve ``OK", por lo que redirige al usuario a la pagina principal de el acceso al cliente.
			\item El usuario no tiene una sesión activa e intenta cerrarla: la BD devuelve ``Error" y el gestor de usuarios devuelve ``Error". No se muestra un mensaje ya que se redirige al usuario a la pagina principal de acceso al cliente.
		\end{itemize}
		
	\item \textbf{Registro}:		
		\begin{figure}[H]
			\begin{center}
				\includegraphics[scale=0.4]{disenoregistro_correcto.jpg}
				\caption{Diagrama de secuencia de registro (correcto).}
			\end{center}	
		\end{figure}
		
		\begin{figure}[H]
			\begin{center}
				\includegraphics[scale=0.4]{disenoregistro_incorrecto.jpg}
				\caption{Diagrama de secuencia de registro (incorrecto).}
			\end{center}	
		\end{figure}
		
		El usuario sin registrar deberá rellenar el formulario con sus datos, luego al pulsa el botón ``Aceptar" el gestor de usuarios recoge dicha información y a través de una consulta a la base de datos podrá ocurrir lo siguiente:
		\begin{itemize}
			\item Si la base de datos devuelve ``OK" entonces se inserta el nuevo usuario en la BD.
			\item Si la base de datos devuelve ``ValidationError" entonces no se inserta el nuevo usuario en la BD, debido a que el nombre de usuario ya existe. Por lo que se le muestra un mensaje de error.
		\end{itemize} 
	
	\item \textbf{Información}:
		\begin{figure}[H]
			\begin{center}
				\includegraphics[scale=0.4]{disenoatclienteinfo.jpg}
				\caption{Diagrama de secuencia de atención al cliente genérica.}
			\end{center}	
		\end{figure}
		Un usuario registrado pide atención a la aplicación, mediante el gestor de correos se le piden una serie de datos, después de rellenar el formulario el gestor busca, a partir de la información que recoge del formulario, en la base de datos y ésta devuelve la información correspondiente que posteriormente le será mostrada. 
		
		\begin{figure}[H]
			\begin{center}
				\includegraphics[scale=0.4]{disenoinfocorporativa.jpg}
				\caption{Diagrama de secuencia información corporativa.}	
			\end{center}	
		\end{figure}
		Un usuario registrado solicita información a la aplicación, el gestor de correos mediante una consulta a la base de datos le devuelve la información correspondiente a la solicitada.		
	
	\item \textbf{Oficina Virtual}:
		\begin{figure}[H]
			\begin{center}
				\includegraphics[scale=0.4]{disenotareas.jpg}
				\caption{Diagrama de secuencia de tareas pendientes.}
			\end{center}	
		\end{figure}
		El usuario que previamente se ha registrado pincha en el enlace de tareas, el gestor de la oficina virtual consulta a la base de datos sobre las tareas de ese usuario y ésta devuelve sus tareas y el gestor le muestra la información.
		
		\begin{figure}[H]
			\begin{center}
				\includegraphics[scale=0.4]{disenoseguimientos.jpg}
				\caption{Diagrama de secuencia de seguimiento de envíos.}
			\end{center}	
		\end{figure}
		Cuando un usuario registrado solicita el seguimiento de un envío, el gestor de la oficina virtual le pide el identificador y una vez que se lo proporciona el gestor solicita la información a la base de datos, la cual devolverá los datos correspondientes a ese envío y el gestor le mostrará al usuario la información.
	
		\begin{figure}[H]
			\begin{center}
				\includegraphics[scale=0.4]{disenohistorico.jpg}
				\caption{Diagrama de secuencia de historico de envíos.}
			\end{center}	
		\end{figure}
		El cliente (usuario registrado) pide la información de los últimos envíos que realizó, el gestor de la oficina virtual consulta en la base de datos sus últimos envíos, la BD le devuelve esos envíos y el gestor le muestra la información al usuario.
		
		\begin{figure}[H]
			\begin{center}
				\includegraphics[scale=0.4]{disenojustificantes.jpg}
				\caption{Diagrama de secuencia de obtención de justificantes.}
			\end{center}	
		\end{figure}
		Cuando un usuario registrado necesita el justificante o factura de un envío o pedido pinchará en su enlace correspondiente, el gestor de la oficina virtual le pedirá que introduzca el identificador, una vez rellenado el gestor recoge esos datos para hacer una consulta en la base de datos y ésta devolverá la información del justificantes y el gestor le mostrará al usuario dicha información.
	
	\item \textbf{Filatelia}:
		\begin{figure}[H]
			\begin{center}
				\includegraphics[scale=0.4]{disenoapadrinamiento.jpg}
				\caption{Diagrama de secuencia de apadrinamiento.}
			\end{center}	
		\end{figure}
		El usuario registrado quiere realizar la acción de apadrinar debe abonar una cantidad, el gestor de filatelia registra al usuario en la filatelia y la base de datos devuelve ``OK" y el gestor le muestra ``OK" al usuario.
		
		\begin{figure}[H]
			\begin{center}
				\includegraphics[scale=0.4]{disenoasociaciones.jpg}
				\caption{Diagrama de secuencia de asociaciones.}
			\end{center}	
		\end{figure}
		El usuario registrado busca una asociación filatélica, el gestor de la filatelia busca dicha asociación en la base de datos y ésta devuelve esa asociación que será mostrada al usuario en pantalla mediante el previo tratamiento de la información por el gestor.

		\begin{figure}[H]
			\begin{center}
				\includegraphics[scale=0.4]{disenoatcliente.jpg}
				\caption{Diagrama de secuencia de atención al cliente.}
			\end{center}	
		\end{figure}
		El usuario registrado solicita la atención a la aplicación, el gestor de la filatelia le pide que ingrese unos datos, una vez rellenados, el gestor busca dichos datos en la base de datos y ésta devuelve ``OK" con los datos y el gestor muestra la información en pantalla.

		\begin{figure}[H]
			\begin{center}
				\includegraphics[scale=0.4]{disenocolecciones.jpg}
				\caption{Diagrama de secuencia de colecciones filatélicas.}
			\end{center}	
		\end{figure}
		Un usuario registrado solicita la información de un tipo de colección filatélica, el gestor de filatelia pide una serie de datos al usuario, que una vez rellenados busca en la base de datos la información, ésta le devuelve ``OK" con los datos y el gestor le muestra al usuario la información por pantalla.
		
		\begin{figure}[H]
			\begin{center}
				\includegraphics[scale=0.4]{disenogestiononline_correcto.jpg}
				\caption{Diagrama de secuencia de gestión online (correcto).}
			\end{center}	
		\end{figure}
		

		\begin{figure}[H]
			\begin{center}
				\includegraphics[scale=0.4]{disenogestiononline_incorrecto.jpg}
				\caption{Diagrama de secuencia de gestión online (incorrecto).}
			\end{center}	
		\end{figure}
		El usuario registrado desea realizar un pedido sobre un producto, el gestor de filatelia le solicita el ingreso de unos datos, cuando el usuario ingresa esos datos, el gestor comprueba con la base de datos que ese producto existe y devuelve la información del producto, y a partir de dicha información se realiza el pedido, ingresando en la base de datos la información que corresponde. En el caso de que el producto no exista no se podrá hacer efectivo el pedido de dicho producto.
		
		\begin{figure}[H]
			\begin{center}
				\includegraphics[scale=0.4]{disenosucursal.jpg}
				\caption{Diagrama de secuencia de búsqueda de sucursales.}
			\end{center}	
		\end{figure}
		El usuario registrado busca sucursales de una provincia, el gestor de la filatelia busca en la base de datos la lista de sucursales de esa provincia y una vez devuelto el resultado se le muestra la información por pantalla al usuario.
	
	\item \textbf{Envíos}
		\begin{figure}[H]
			\begin{center}
				\includegraphics[scale=0.4]{disenoenvio_correcto.jpg}
				\caption{Diagrama de secuencia de envío (correcto).}
			\end{center}	
		\end{figure}		
	
		\begin{figure}[H]
			\begin{center}
				\includegraphics[scale=0.4]{disenoenvio_incorrecto.jpg}
				\caption{Diagrama de secuencia de envío (incorrecto).}
			\end{center}	
		\end{figure}
		El usuario registrado desea realizar un envío, el gestor de envíos le solicita la información del envío, el cliente ingresa los datos correspondientes y pueden suceder dos situaciones:
		\begin{itemize}
			\item El gestor intenta registrar los datos del envío en la base de datos y ésta le responde con ``OK", por lo que el gestor devuelve un ``OK" al usuario.
			\item El gestor intenta registrar los datos del envío en la base de datos y ésta le responde con ``ErrorDatos", por lo que el gestor devuelve un ``ErrorDatos" al usuario con el motivo de que se corrijan esos datos incorrectos.
		\end{itemize}
		
	\end{itemize}	
		
\subsection{DSI 3.3: Revisión de la Interfaz de Usuario}
	La interfaz de usuario está estructuradas en los tres perfiles de usuarios existentes en el sistema, que son:
	\begin{itemize}
		\item Interfaz para el perfil de Cliente Particular:
			\begin{figure}[H]
				\begin{center}
					\includegraphics[scale=0.5]{particulares_principal.pdf}
					\caption{Captura de la interfaz principal de particulares}
				\end{center}
			\end{figure}
			Como podemos ver en la captura anterior, la estructura de la interfaz para particulares sigue el esquema descrito. El menú a la izquierda permite al usuario acceder a todas las opciones disponibles con un sólo click, y se encuentra ordenado por la frecuencia de uso de cada una de las opciones. Cada evento vendrá representado por un click con el ratón en el menú elegido, que llevará a la modificación del contenido de la interfaz. Este contenido dependerá de la opción elegida, por lo que no se puede tratar de manera estática.
			
		\item Interfaz para el perfil de Cliente Empresa:
			\begin{figure}[H]
				\begin{center}
					\includegraphics[scale=0.5]{empresas_principal.pdf}
					\caption{Captura de la interfaz principal de empresas}
				\end{center}
			\end{figure}	
			En este caso, las opciones disponibles son las de empresas, pero la estructura global de la pantalla es la misma. Los eventos se gestionan de la misma forma, al recibir clicks de ratón.		
		
		\item Intrefaz para la Oficina Virtual, en la que el usuario deberá estar registrado para acceder a ella:
			\begin{figure}[H]
				\begin{center}
					\includegraphics[scale=0.5]{oficina_virtual_principal.pdf}
					\caption{Captura de la interfaz principal de oficina virtual}
				\end{center}
			\end{figure}	
			Para la oficina virtual la estructura es la misma pero con las opciones propias de la oficina. Gracias a esto, el portal mantiene un aspecto homogéneo que no intimida al usuario ni lo desconcierta.
	\end{itemize}
	
	Los \textit{formatos de impresión} serán los mismos para todos los documentos, con el logo de la empresa en la parte superior, junto con el titulo del documento y el número de página. Los documentos disponibles para la impresión son los siguientes:
	\begin{itemize}
		\item \textbf{Justificantes:} Los justificantes de las facturas pagadas incluirán al comienzo el número y fecha de facturación, y tras esto, la información referente a la factura.
		\item \textbf{Seguimiento de envíos:} Los seguimientos de envíos figurarán en forma de tabla, dividida por las siguientes columnas: fecha, estado. De esta forma el usuario identifica de forma clara los estados por lo que ha ido pasando el envío.
		\item \textbf{Producto filatélico:} La impresión de información de un producto filatélico se dispondrá con una imagen del mismo que ocupará el cuarto superior izquierdo del documento, junto con la información del documento debajo del mismo, ocupando el resto del mismo.
		\item \textbf{Facturas:} Las facturas serán todas similares en el aspecto. Contendrán el número de factura a la izquierda y a la derecha el nombre del titular de la factura. A continuación aparecerá una tabla dividida por las columnas de \textit{descripción} y \textit{precio}. El contenido de esa tabla será la descripción de cada compra y el precio asociado a la misma, a razón de una por línea.
	\end{itemize}

\subsection{DSI 3.4: Revisión de Subsistemas de Diseño e Interfaces}
	


\newpage


\section{DSI 4: Diseño de Clases}

\subsection{DSI 4.1: Identificación de Clases Adicionales}

\subsection{DSI 4.2: Diseño de Asociaciones y Agregaciones}

\subsection{DSI 4.3: Identificación de Atributos de las Clases}

\subsection{DSI 4.4: Identificación de Operaciones de las Clases}

\subsection{DSI 4.5: Diseño de la Jerarquía}

\subsection{DSI 4.6: Descripción de Métodos de las Operaciones}

\subsection{DSI 4.7: Especificación de Necesidades de Migración y Carga Inicial de Datos}


\newpage


\section{DSI 6: Diseño Físico de Datos}

\subsection{DSI 6.1: Diseño del Modelo Físico de Datos}
	El software de base de datos a utilizar en el servidor correspondiente será Oracle, el cual utiliza un lenguaje de consulta estructurado (SQL). El contenido de esta base de datos será:
	\begin{itemize}
		\item \textit{Tabla de Usuarios}: campos: 
				\begin{itemize}
					\item Código (Primary Key), 
					\item Nombre Personal, 
					\item Apellidos, 
					\item DNI (Unique),
					\item Nombre de Usuario (Unique), 
					\item Contraseña (cifrada),
					\item Dirección, 
					\item Número, 
					\item Piso,
					\item Letra,
					\item Escalera,
					\item Teléfono. 
				\end{itemize}
		\item \textit{Tabla de Productos}: campos:
				\begin{itemize}
					\item Código (Primary Key),
					\item Nombre,
					\item Descripción,
					\item Precio.
				\end{itemize}
		\item \textit{Tabla de Envíos}: campos:
				\begin{itemize}
					\item Código (Primary Key),
					\item Usuario Destino (Foreign Key a la tabla Usuarios),
					\item Usuario Remitente (Foreign Key a la tabla Usuarios),
					\item Contenido del envío,
					\item Localización del envío: irá cambiando su estado dependiendo de su situación. Por ejemplo: inicialmente puede estar ``En Proceso", cuando ha salido del almacén puede estar ``Salida de Almacén", y finalmente cuando llegue a su destino ``Envío Realizado".
				\end{itemize}
		\item \textit{Tabla de Pedidos}: campos:
				\begin{itemize}
					\item Código (Primary Key),
					\item Lista de Productos a enviar (cada elemento de la lista será una clave ajena -Foreign Key- a la tabla de Productos),
					\item Usuario que realiza el pedido (Foreign Key a la tabla Usuarios),
					\item Estado del Pedido: al igual que en la tabla anterior este campo indica la situación del pedido: Por ejemplo: inicialmente puede estar en ``Pedido en almacén", después ``Pedido fuera del almacén", luego ``Pedido en el reparto" y finalmente ``Pedido Entregado". 
				\end{itemize}
		\item \textit{Tabla de Colecciones} campos:
				\begin{itemize}
					\item Código (Primary Key),
					\item Nombre,
					\item Descripción.
				\end{itemize}
		\item \textit{Tabla de Asociaciones} campos:
				\begin{itemize}
					\item Código (Primary Key),
					\item Nombre,
					\item Dirección,
					\item Provincia en la que está situada,
					\item Teléfono de contacto,
					\item Número de Fax,
					\item Descripción.					
				\end{itemize}
	\end{itemize}

	Los datos que serán migrados de la aplicación anterior son los respectivos a los Usuarios que ya se habían registrado con anterioridad, los productos que todavía sigue utilizando el sistema, los pedidos tanto los entregados como los que están en proceso, los envíos tanto los que han llegado a su destino como los que todavía se encuentran de camino o en el almacén, asociaciones filatélicas disponibles y colecciones filatélicas.\\

	Siempre que un servidor quiera realizar una consulta en la base de datos la deberá hacer mediante campos que sean claves primarias o únicas, ya que de esta forma se agiliza mucho la devolución de los datos, y a partir de hay irá obteniendo la información complementaria de ese registro o registros que se desee. Exceptuando los casos en los cuales se quiera obtener una lista de datos, como por ejemplo obtener la lista de asociaciones filatélicas que corresponden a una provincia determinada, esta consulta se deberá hacer sobre el campo provincia de la tabla asociaciones.\\

	El sistema de la base de datos será implementado de tal manera que jamás se permitirá el acceso a más de un servidor a un mismo registro de la misma tabla con el fin de evitar los problemas de consistencia de datos que se podrían dar como consecuencia de la concurrencia entre servidores.

\subsection{DSI 6.2: Especificación de los Caminos de Acceso a los Datos}
	Los servidores tendrán acceso a los datos mediante una conexión de red local (LAN) al servidor de base de datos.\\

	Cómo se ha indicado en el punto anterior el sistema ya implementa los mecanismos adecuados para resolver los problemas de concurrencia que podrían surgir si más de un servidor desea obtener exactamente la misma información del servidor de base de datos.\\	
	
	Respecto a la seguridad del acceso a estos datos se requerirá la identificación correcta de los servidores desde los que se puede acceder a dicha información. Es decir, el servidor de BBDD mantendrá una tabla con las MAC de los servidores que tendrán acceso a éste, y además cada servidor tendrá el nombre de usuario y contraseña necesario para realizar las consultas. Cualquier otro servidor que quiera realizar una consulta a esta base de datos no podrá hacerla debido a que éste no está registrado en dicha tabla del servidor de BBDD.

\subsection{DSI 6.3: Optimización del Modelo Físico de Datos}
	Con el fin de mejorar los tiempos de respuesta de estos servidores las consultas se realizarán sobre datos muy concretos (si es posible) para evitar ciertos retrasos innecesarios al realizar dichas consultas sobre un conjunto muy amplio de datos. \\
	
	Cada servidor irá almacenando esas pequeñas consultas, mientras los datos no se vean modificados, para evitar tener que hacer dos consultas seguidas sobre la misma información y así poder eliminar cuellos de botella al acceder a la vez a la base de datos varios servidores. Por lo que estos servidores tendrán una pequeña caché en la que almacenarán esos datos. El sistema empleado para esta caché será de reemplazo de los datos más antiguos, es decir, cuando la caché esté llena el sistema de reemplazamiento a utiliza será FIFO (First In First Out). \\
	
	El servidor de base de datos llevará un registro de qué información tiene cada servidor para que en el caso de modificación de esos datos avisar a dichos servidores de que borren de su caché esos datos y en la próxima solicitud de esa información deberá hacer una nueva consulta a la base de datos.

\subsection{DSI 6.4: Especificación de la Distribución de Datos}
	Toda la información estará situada en el servidor de base de datos. Pero parcialmente cada servidor tendrá una pequeña parte de esta información en sus cachés, que como se ha mencionado anteriormente, sirven para la mejora del tiempo de respuesta y para evitar cuellos de botella que se provocarían cuando muchos servidores desean realizar consultas sobre una misma base de datos. Esto debe realizarse de esta forma ya que el número de visitas media por mes alcanza las 400.000 (cuatrocientas mil).


\newpage


\section{DSI 8: Generación de Especificaciones de Construcción}

\subsection{DSI 8.1: Especificación del Entorno de Construcción}

\subsection{DSI 8.2: Definición de Componentes y Subsistemas de Construcción}

\subsection{DSI 8.3: Elaboración de Especificaciones de Construcción}

\subsection{DSI 8.4: Elaboración de Especificaciones del Modelo Físico de Datos}


\newpage


\section{DSI 9: Diseño de la Migración y Carga Inicial de Datos}

\subsection{DSI 9.1: Especificación del Entorno de Migración}

\subsection{DSI 9.2: Diseño de Procedimientos de Migración y Carga Inicial}

\subsection{DSI 9.3: Diseño Detallado de Componentes de Migración y Carga Inicial}

\subsection{DSI 9.4: Revisión de la Planificación de la Migración}


\newpage


\section{DSI 10: Especificación Técnica del Plan de Pruebas}

\subsection{DSI 10.1: Especificación del Entorno de Pruebas}

\subsection{DSI 10.2: Especificación Técnica de Niveles de Prueba}

\subsection{DSI 10.3: Revisión de la Planificación de Pruebas}


\newpage


\section{DSI 11: Establecimiento de Requisitos de Implantación}

\subsection{DSI 11.1: Especificación de Requisitos de Documentación de Usuario}

\subsection{DSI 11.2: Especificación de Requisitos de Implantación}


\end{document}